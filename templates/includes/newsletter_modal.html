{% load static %}

<div class="modal fade" id="newsletterModal" tabindex="-1" aria-labelledby="newsletterModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content rounded-3">
      <div class="modal-header">
        <h5 class="modal-title" id="newsletterModalLabel">Join our newsletter</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <p id="nl-hint" class="text-muted mb-3">Get exclusive offers and early access.</p>

        <!-- Signup form (modal) -->
        <form id="nl-form" method="post" action="{% url 'newsletter_subscribe' %}">
          {% csrf_token %}
          <div class="input-group">
            <input
              id="nl-email"
              name="email"
              type="email"
              class="form-control"
              placeholder="you@example.com"
              required
            />
            <button class="btn btn-primary" type="submit">Subscribe</button>
          </div>
          {% if form.errors.email %}
            <div class="text-danger small mt-2">{{ form.errors.email }}</div>
          {% endif %}
        </form>

        <!-- Success panel (hidden by default) -->
        <div id="nl-success" class="d-none mt-3">
          <div class="alert alert-success mb-2">
            Welcome aboard! Your code:
            <code id="nl-code">••••••</code>
          </div>
          <button id="nl-copy" type="button" class="btn btn-outline-secondary btn-sm">Copy</button>
          <span id="nl-copied" class="small ms-2 d-none">Copied</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- IMPORTANT: Ideally include this script only once per page (e.g., in base.html).
     If you keep it here, ensure the inline partial does NOT also include it. -->
<script defer src="{% static 'newsletter/newsletter.js' %}"></script>
