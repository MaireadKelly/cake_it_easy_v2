{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
  <h1>My Orders</h1>

  {% if orders %}
    <table class="table mt-3">
      <thead>
        <tr>
          <th>ID</th>
          <th>Date</th>
          <th>Total (Paid)</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for order in orders %}
          <tr>
            <td>{{ order.id }}</td>
            <td>{{ order.created_on|date:"Y-m-d H:i" }}</td>

            {# IMPORTANT: show final paid total (grand_total) #}
            <td>
              â‚¬{{ order.grand_total|floatformat:2 }}
              {% if order.discount_amount and order.discount_amount > 0 %}
                <span class="badge bg-success ms-2">
                  Discount ({{ order.discount_code }})
                </span>
              {% endif %}
            </td>

            <td class="text-end">
              <a class="btn btn-sm btn-outline-primary" href="{% url 'order_detail' order.id %}">View</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>You have no orders.</p>
  {% endif %}
</div>
{% endblock %}
