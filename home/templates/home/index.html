{% extends "base.html" %}
{% load static %}

{% block meta_description %}
Celebration cakes, cupcakes, custom designs, balloons & candles. Sign up for 10% off your first order. Free delivery over €50.
{% endblock %}

{% block content %}

<!-- HERO -->
<section class="hero container my-4">
  <div class="hero-card row align-items-center">
    <!-- Text / CTAs -->
    <div class="col-lg-6 p-4 p-md-5">
      <span class="badge rounded-pill bg-light text-dark text-uppercase mb-2">Fresh · Local · Made to order</span>
      <h1 class="display-5 fw-bold mb-2">Hand-made cakes for every celebration</h1>
      <p class="lead text-muted mb-4">
        From classic sponges to <em>one-of-a-kind</em> designs. Sign up and get <strong>10% off</strong> your first order.
      </p>

      {% url 'products' as products_url %}
      {% if not products_url %}{% url 'product_list' as products_url %}{% endif %}
      {% if not products_url %}{% url 'all_products' as products_url %}{% endif %}

      <div class="d-flex flex-wrap gap-2">
        <!-- Modal trigger -->
        <button class="btn btn-primary"
                type="button"
                data-bs-toggle="modal"
                data-bs-target="#newsletterModal">
          Get 10% off
        </button>

        <!-- Noscript fallback (only shows if JS disabled) -->
        <noscript>
          <a href="#newsletter" class="btn btn-primary">Get 10% off</a>
        </noscript>

        <!-- Products link: falls back to /products/ if no named URL present -->
        <a href="{{ products_url|default:'/products/' }}" class="btn btn-outline-secondary">Shop Cakes</a>
      </div>
    </div>

    <!-- Image -->
    <div class="col-lg-6 text-center p-3 p-md-4">
      <img
        src="{% static 'images/shopfront.jpg' %}"
        alt="Layered celebration cake with frosting and flowers"
        class="hero-img img-fluid rounded shadow-sm" />
    </div>
  </div>
</section>

<!-- FEATURED / LATEST -->
{% if products %}
<section class="container my-4">
  <h2 class="h4 mb-3">Featured This Week</h2>
  <div class="row product-grid">
    {% for product in products|slice:":4" %}
      <div class="col-md-3 mb-3">
        <div class="card h-100">
          <div class="image-frame">
            {% if product.image %}
              <img src="{{ product.image.url }}" alt="{{ product.name }}">
            {% else %}
              <img src="{% static 'images/default.jpg' %}" alt="{{ product.name }}">
            {% endif %}
          </div>
          <div class="card-body d-flex flex-column">
            <h6 class="mb-1">{{ product.name }}</h6>
            <p class="text-muted mb-2">€{{ product.price|floatformat:2 }}</p>
            <a href="{% url 'product_detail' product.id %}" class="btn btn-outline-primary btn-sm mt-auto">View</a>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</section>
{% endif %}

{% endblock %}
